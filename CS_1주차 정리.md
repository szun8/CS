# 1장 운영체제
## 의미
- 하드웨어 계층과 응용소프트웨어 계층을 연결하는 시스템 소프트웨어 계층
- 한정적인 자원을 효율적으로 관리

## 목적
정확하고 빠르게 주어진 문제를 해결하는 것
- 반환시간 단축
- 처리능력 향상
- 사용가능도 향상
- 신뢰도 향상

## 🧠 CPU : central processing Unit
- 중앙처리장비, 컴퓨터의 뇌
- 프로그램 실행에 필요한 연산 처리 및 수행
	- 프로세서 : 하나의 프로세스만 처리

### 메모리 구조
항상 4개의 메모리가 묶여 설명되는 이유
	- CPU에서 원하는 연산을 처리하기 위해서는 그에 필요한 데이터가 적재(load)되고 그것을 활용하는 것이기 때문에 데이터를 담는 메모리 구조가 같이 언급된 것
- 레지스터
	- 프로그램을 메모리에 로드
		- 프로세스
- 캐시
- RAM 주기억장치 (휘발성)
- 보조기억장치 (비휘발성)
	- HDD
	- SSD

## Kernel
- 사용자모드와 커널모드 존재
- 시스템 콜
	- fork
		- 자기 자신을 복제하여 자식 프로세스 시작
		- 복제된 순간부터 동리 코드 스레드 수만큼 반환 결과에 따라 코드 호출
	- wait
	- exit
		- 서비스 정상 종료

# 2장 프로세스
## 의미
- 실행중인 하나의 프로그램
	- 특정 작업을 수행하기 위한 명령어의 집합
	- 한 개 이상의 스레드를 가짐
- 프로그램이 처리되는 프로세스 하나의 메모리 영역

### Stack(LIFO)
- 지역변수, 함수 매개변수, 반환되는 주소 값이 저장
- 높은 주소에서 시작하여 메모리가 할당될 때마다 낮은 주소 쪽으로 메모리를 할당
- 컴파일때 해당 영역의 크기가 결정

### Overflow
- 메모리를 공유하기 때문에 서로의 영역을 침범하는 행위
	- 스택 오버플로우
	- 힙 오버플로우

### Heap(FIFO)
- 동적 메모리 할당
	- C++ new & delegate -> 스마트 포인터, C#의 Disposed
- 낮은 주소에서 높은 주소 쪽으로 메모리 할당
- 런타임때 해당 영역의 크기가 결정

### Data
- 전역(global) 변수, 정적(static)변수, 배열, 구조체등이 저장
- 초기화 여부에 따라
	- false
		- BSS(BlockStatedSymbol)
	- true
		- 데이터 영역
### Code
- 텍스트영역
- 사람이 처리한 자연어 코드를 기계어로 컴파일하여 보관된 영역

## PCB : ProcessControlBlock

### 운영체제가 프로세스를 제어하기 위해 프로세스 정보를 저장하는 곳
- 프로세스의 현재 상태
- PID
	- 부모
	- 프로세스 고유
	- 자식
- PC
	- 다음 실행할 명령어의 주소저장공간
- 스팩포인터
	- 스택 영역에서 데이터가 채워진 마지막 값의 위치를 찾아갈 수 있는 가장 첫 포인터
		- 재귀 형태를 통해 최하위 스택 메모리까지 접근

## 프로세스 상태도

### 생성
- 준비
	- 실행 : 인터럽트 발생으로 준비로 회귀
	- 대기 : 입출력, 이벤트 발생으로 대기 큐 진입 및 실행으로 회귀
- 종료

## 멀티
### 동시성
- 하나의 CPU에서 여러 개의 작업을 번갈아 가면서 처리하는 방식
	- 콘텍스트 스위칭
		- 처리중인 작업을 교체하는 행위
		- 오버헤드 : A작업에서 B작업으로 바꾸기 위해 소모되는 시간과 비용

### 병렬성
- 멀티코어가 다중 작업 동시 처리

### 멀티 프로세스
- 하나의 프로그램을 여러 프로세스로 구성하는
- IPC : Inter Process Communication
	- 프로세스간의 자원공유
		- 공유 메모리
		- 소켓
		- 세마포어
		- 파이프
		- 메시지 큐
- CPU 스케줄러
	- 인터럽트가 발생하면 콘텍스트 스위칭이 이뤄짐
		- 콘텍스트 : CPU가 처리하는 프로세스의 정보
		- 이때 현재 상태를 현재 프로세스의 PCB에 저장하고 실행할 프로세스의 PCB를 로드
			=> 로드하는 동안 CPU는 어떠한 일도 하지 못하는 바보같은 상황 발생

### 멀티스레드
- 공유 자원의 동기화
- 멀티프로세스보다 자원 소모가 효율적
	- 현재 프로세스 안의 힙, 데이터, 코드영역의 데이터를 공유해서 사용
		- 프로세스가 바뀔 때 힙, 데이터, 코드 영역의 데이터까지 스위칭해야하는 비용이 없기때문에

### 프로세스 동기화 for 데이터의 일관성
- 하나의 자원에 여러 프로세스(스레드)가 접근할 경우 데이터의 일관성이 무너질 수 있음
- 경쟁상태
	- 우유문제
- 임계영역
	- 접근 순서에 따라 결과가 달라지는 코드 영역
	- 동시 접근 방지 조건
		- 상호배제 기법
			- 뮤텍스 lock
				- 화장실 키가 하나
				- 락킹 매커니즘
					- 바쁜 대기 - 스핀락
			- 세마포어 count
				- 화장실 키가 화장실 갯수대로 존재
				- 시그널링 매커니즘
					- 다른 프로세스가 접근할 수 있도록 신호를 보냄
					- broadcast message
		- 진행
		- 한정된 대기

### 교착상태 deadlock
2개 이상의 프로세스가 각각 자원을 가지고 있으면서 서로의 자원을 요구하며 기다리는 상태
- 상호배제
- 점유와 대기
- 비선점, 환형 대기

## 스레드
프로세스에서 실제로 실행되는 흐름의 단위
- 자기 자신은 스택영역을 이용
- 공유는 힙영역을 이용

사용자 레벨 스레드와 커널 레벨 스레드 존재 

관계성
- 다대일 : 병렬성 사용불가
- 일대일 : 사용자 스레드 만큼 커널도 생성되어 성능 저하 우려
- 다대다 : n:m (m<=n)